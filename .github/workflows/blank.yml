# name: SecurityPipeline

# on:
#   push:
#     branches:
#       - main
#   pull_request:
#     branches:
#       - main

# jobs:
#   horusec-security:
#     name: Horusec Security
#     runs-on: ubuntu-latest
#     steps:
#       - name: Check out code
#         uses: actions/checkout@v2
#         with:
#           fetch-depth: 0
#       - name: Install Horusec
#         run: |
#           curl -fsSL https://raw.githubusercontent.com/ZupIT/horusec/main/deployments/scripts/install.sh | bash -s latest
#       - name: Run Horusec Security
#         run: horusec start -p . -e="true"

name: Clone Bitbucket Repository

on:
  push:
    branches:
      - main

jobs:
  clone-repository:
    name: Clone Bitbucket Repository
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
        with:
          # Use your Bitbucket repository SSH URL
          repository: git clone git@bitbucket.org:feedz-workspace/feedz-horusec-image.git
      - name: Configure SSH
        run: |
          mkdir -p ~/.ssh
          echo "$BITBUCKET_SSH_PRIVATE_KEY" > ~/.ssh/id_rsa
          chmod 600 ~/.ssh/id_rsa
          ssh-keyscan bitbucket.org >> ~/.ssh/known_hosts

